<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pressure Pulse</title>
  <style>
    :root {
      color-scheme: dark;
      --accent: #ff4f8c;
      --accent-2: #6cf7ff;
      --bg: radial-gradient(circle at top, #162131, #05070c 60%);
    }

    * {
      box-sizing: border-box;
    }

    body {
      font-family: "Space Grotesk", "Segoe UI", system-ui, -apple-system, sans-serif;
      min-height: 100vh;
      margin: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--bg);
      color: #eff6ff;
    }

    .panel {
      width: min(680px, 92vw);
      background: rgba(2, 9, 20, 0.78);
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: 24px;
      padding: 32px;
      box-shadow: 0 20px 70px rgba(4, 6, 15, 0.7);
      backdrop-filter: blur(12px);
    }

    h1 {
      margin: 0 0 12px;
      font-size: clamp(1.5rem, 4vw, 2.1rem);
      letter-spacing: 0.04em;
    }

    .score-board {
      display: flex;
      align-items: baseline;
      gap: 16px;
      margin-bottom: 18px;
      flex-wrap: wrap;
    }

    .score {
      font-size: 2.75rem;
      font-weight: 600;
      color: var(--accent-2);
    }

    .status {
      min-height: 1.2em;
      font-size: 1rem;
      letter-spacing: 0.05em;
    }

    .instructions {
      margin-bottom: 28px;
      line-height: 1.5;
      color: rgba(239, 246, 255, 0.8);
      font-size: 0.98rem;
    }

    .pressure-meter {
      position: relative;
      width: min(640px, 100%);
      height: 120px;
      margin: 0 auto;
      border-radius: 999px;
      border: 2px solid rgba(255, 255, 255, 0.12);
      background: linear-gradient(90deg, #141e33, #0b0f1b 50%, #141e33);
      overflow: hidden;
    }

    .pressure-meter::before {
      content: "";
      position: absolute;
      inset: 10px;
      border-radius: inherit;
      background: linear-gradient(90deg, rgba(255, 255, 255, 0.05), transparent 20%, transparent 80%, rgba(255, 255, 255, 0.05));
      pointer-events: none;
    }

    #pulseArea {
      position: absolute;
      top: 15px;
      bottom: 15px;
      border-radius: 999px;
      background: radial-gradient(circle, rgba(255, 79, 140, 0.55), rgba(255, 79, 140, 0.0));
      opacity: 0;
      transform: scaleX(0.9);
      transition: opacity 0.2s ease, filter 0.2s ease, transform 0.2s ease;
      filter: blur(0);
      pointer-events: none;
    }

    #pulseArea.active {
      opacity: 0.85;
      animation: throb 0.65s ease-in-out infinite;
      transform: scaleX(1);
      filter: blur(2px);
    }

    @keyframes throb {
      0% {
        transform: scaleY(0.9);
        opacity: 0.5;
      }

      50% {
        transform: scaleY(1.05);
        opacity: 0.9;
      }

      100% {
        transform: scaleY(0.9);
        opacity: 0.5;
      }
    }

    #square {
      position: absolute;
      width: 46px;
      height: 46px;
      border-radius: 12px;
      top: calc(50% - 23px);
      background: linear-gradient(135deg, var(--accent), #ffd466);
      box-shadow: 0 10px 25px rgba(255, 79, 140, 0.35);
      border: 2px solid rgba(0, 0, 0, 0.35);
      transition: transform 0.12s ease;
    }

    #square.burst {
      animation: burst 0.9s ease forwards;
    }

    @keyframes burst {
      0% {
        transform: scale(1);
        opacity: 1;
      }

      45% {
        transform: scale(1.4) rotate(6deg);
        opacity: 0.5;
      }

      100% {
        transform: scale(0);
        opacity: 0;
      }
    }

    .keys-hint {
      margin-top: 24px;
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: rgba(255, 255, 255, 0.6);
      text-align: center;
    }
  </style>
</head>

<body>
  <div class="panel">
    <h1>Pressure Pulse</h1>
    <div class="score-board">
      <div class="score" id="score">0</div>
      <div class="status" id="status">Find the pulsing zone. Space = lock it in.</div>
    </div>
    <p class="instructions">
      Glide the square through the pressure meter with the arrow keys (or A / D). When the meter begins to pulse, tap
      the spacebar immediately to capture the sweet spot. Nail the timing to gain points. Miss the pulse and the square
      will burst, costing you a point before it returns for another attempt.
    </p>
    <div class="pressure-meter" id="meter">
      <div id="pulseArea"></div>
      <div id="square"></div>
    </div>
    <div class="keys-hint">⬅ ➡ / A D to move · SPACE to lock in the pulse</div>
  </div>

  <script>
    const meter = document.getElementById('meter');
    const square = document.getElementById('square');
    const pulseArea = document.getElementById('pulseArea');
    const status = document.getElementById('status');
    const scoreEl = document.getElementById('score');

    const step = 18;
    const zonePadding = 36;
    const zoneRange = [90, 150];

    let meterWidth = meter.clientWidth;
    const squareWidth = square.offsetWidth;
    let squareX = meterWidth / 2 - squareWidth / 2;
    let pulseZone = createZone();
    let pulseActive = false;
    let bursting = false;
    let score = 0;

    positionSquare();
    updatePulseArea(false);

    window.addEventListener('resize', () => {
      meterWidth = meter.clientWidth;
      squareX = clamp(squareX, 0, meterWidth - squareWidth);
      pulseZone = keepZoneInBounds(pulseZone);
      positionSquare();
      updatePulseArea(pulseActive);
    });

    document.addEventListener('keydown', (event) => {
      if (bursting) {
        return;
      }
      if (event.repeat && event.code !== 'Space') {
        event.preventDefault();
      }

      if (event.code === 'ArrowLeft' || event.code === 'KeyA') {
        moveSquare(-step);
      } else if (event.code === 'ArrowRight' || event.code === 'KeyD') {
        moveSquare(step);
      } else if (event.code === 'Space') {
        event.preventDefault();
        handleSpace();
      }
    });

    function moveSquare(delta) {
      squareX = clamp(squareX + delta, 0, meterWidth - squareWidth);
      positionSquare();
      updatePulseState();
    }

    function handleSpace() {
      if (pulseActive) {
        score++;
        updateScore();
        flashStatus('Perfect timing! +1');
        resetPulse();
      } else {
        if (score > 0) {
          score--;
          updateScore();
        }
        flashStatus('Too soon! -1');
        burstSquare();
      }
    }

    function burstSquare() {
      bursting = true;
      square.classList.add('burst');
      setTimeout(() => {
        square.classList.remove('burst');
        bursting = false;
        square.style.opacity = '1';
      }, 1000);
    }

    function updatePulseState() {
      const squareCenter = squareX + squareWidth / 2;
      const withinZone = squareCenter >= pulseZone.start && squareCenter <= pulseZone.end;
      if (withinZone && !pulseActive) {
        pulseActive = true;
        updatePulseArea(true);
        flashStatus('Pulse live! Hit space!');
      } else if (!withinZone && pulseActive) {
        pulseActive = false;
        updatePulseArea(false);
        flashStatus('Searching...');
      }
    }

    function resetPulse() {
      pulseActive = false;
      pulseZone = createZone();
      updatePulseArea(false);
    }

    function updatePulseArea(active) {
      pulseArea.style.left = `${pulseZone.start}px`;
      pulseArea.style.width = `${pulseZone.end - pulseZone.start}px`;
      pulseArea.classList.toggle('active', active);
    }

    function positionSquare() {
      square.style.left = `${squareX}px`;
    }

    function flashStatus(text) {
      status.textContent = text;
    }

    function updateScore() {
      scoreEl.textContent = score;
    }

    function createZone() {
      const zoneWidth = randBetween(...zoneRange);
      const maxStart = meterWidth - zoneWidth - zonePadding;
      const start = randBetween(zonePadding, Math.max(zonePadding, maxStart));
      const end = start + zoneWidth;
      return { start, end };
    }

    function keepZoneInBounds(zone) {
      const width = zone.end - zone.start;
      const maxStart = meterWidth - width - zonePadding;
      const start = clamp(zone.start, zonePadding, Math.max(zonePadding, maxStart));
      return { start, end: start + width };
    }

    function clamp(value, min, max) {
      return Math.min(Math.max(value, min), max);
    }

    function randBetween(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }
  </script>
</body>

</html>
